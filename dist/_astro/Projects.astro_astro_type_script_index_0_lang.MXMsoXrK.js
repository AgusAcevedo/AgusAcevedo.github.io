const P=document.querySelectorAll(".magia");console.log("Total articles found:",P.length);const v=document.querySelectorAll(".filter-btn"),i=document.getElementById("cert-modal"),y=document.getElementById("modal-title"),L=document.getElementById("modal-date"),B=document.getElementById("modal-image"),k=document.getElementById("modal-link"),x=document.getElementById("modal-close"),E=document.getElementById("modal-issuers-list"),F=document.querySelectorAll(".modal-open"),g=document.getElementById("prev-page"),u=document.getElementById("next-page"),f=document.getElementById("prev-page-mobile"),p=document.getElementById("next-page-mobile"),H=document.getElementById("page-dots"),O=document.getElementById("page-dots-mobile"),m=document.getElementById("carousel-track"),w=document.getElementById("carousel-container");let l=0,s=8,c=[],C=0;function T(){const e=window.innerWidth;e<640?s=4:e<1024||e<1280?s=6:s=8}function S(){T();const e=Math.ceil(c.length/s);console.log("Creating carousel with",c.length,"articles,",e,"pages"),m.innerHTML="";for(let t=0;t<e;t++){const n=document.createElement("div");n.className="min-w-full px-1";const o=document.createElement("div");o.className="grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 py-2";const a=t*s,r=a+s;c.slice(a,r).forEach(X=>{const h=X.cloneNode(!0);h.classList.remove("hidden"),h.style.display="",o.appendChild(h)}),n.appendChild(o),m.appendChild(n)}z(),q(e),d(0)}function z(){m.querySelectorAll(".modal-open").forEach(t=>{t.addEventListener("click",()=>{D({title:t.dataset.title||"",date:t.dataset.date||"",image:t.dataset.image||"",link:t.dataset.link||""})})})}function d(e){const t=Math.ceil(c.length/s);l=Math.max(0,Math.min(e,t-1));const n=-l*100;m.style.transform=`translateX(${n}%)`,q(t)}function q(e){g&&(g.disabled=l===0),u&&(u.disabled=l===e-1),f&&(f.disabled=l===0),p&&(p.disabled=l===e-1),[H,O].forEach(n=>{if(n){n.innerHTML="";for(let o=0;o<e;o++){const a=document.createElement("button");a.className=`w-2 h-2 rounded-full transition ${o===l?"bg-violet-400 scale-125":"bg-gray-600 hover:bg-gray-500"}`,a.addEventListener("click",()=>d(o)),n.appendChild(a)}}});const t=document.getElementById("pagination-controls");t&&(t.style.display=e<=1?"none":"flex")}function _(e){console.log("Applying filter:",e),v.forEach(o=>o.classList.remove("border-violet-400","border-violet-500","text-violet-700","dark:text-white","bg-violet-500/10","shadow-[0_0_0_1px_rgba(124,58,237,0.4)]"));const t=Array.from(v).find(o=>o.dataset.filter===e);t&&t.classList.add("border-violet-500","text-violet-700","dark:text-white","bg-violet-500/10","shadow-[0_0_0_1px_rgba(124,58,237,0.4)]");const n=document.getElementById("filter-select");n&&(n.value=e),c=Array.from(P).filter(o=>{const a=o.dataset.categories||"",r=o.dataset.featured==="true";return e==="featured"?r:e==="all"?!0:a.includes(e)}),console.log("Filtered articles:",c.length),S()}v.forEach(e=>{e.addEventListener("click",()=>{_(e.dataset.filter||"")})});const I=document.getElementById("filter-select");I&&I.addEventListener("change",e=>{_(e.target.value)});g&&g.addEventListener("click",()=>d(l-1));u&&u.addEventListener("click",()=>d(l+1));f&&f.addEventListener("click",()=>d(l-1));p&&p.addEventListener("click",()=>d(l+1));w.addEventListener("touchstart",e=>{C=e.changedTouches[0].clientX},{passive:!0});w.addEventListener("touchend",e=>{const t=e.changedTouches[0].clientX,n=C-t;Math.abs(n)>50&&(n>0?d(l+1):d(l-1))},{passive:!0});const D=e=>{if(y&&(y.textContent=e.title),L&&(L.textContent=e.date),E){E.innerHTML="";const t=Array.from(m.querySelectorAll(".modal-open")).find(n=>n.dataset.title===e.title);if(t){const n=t.querySelector(".modal-issuers-data");n&&n.querySelectorAll("span").forEach(a=>{const r=a.cloneNode(!0);E.appendChild(r)})}}B&&(B.src=e.image),k&&(k.href=e.link),i&&(i.classList.remove("hidden"),i.classList.add("flex"))};F.forEach(e=>{e.addEventListener("click",()=>{D({title:e.dataset.title||"",date:e.dataset.date||"",image:e.dataset.image||"",link:e.dataset.link||"",issuer:e.dataset.issuer||"",issuerJson:e.dataset.issuerJson||""})})});const N=()=>{i&&(i.classList.add("hidden"),i.classList.remove("flex"))};x&&x.addEventListener("click",N);i&&i.addEventListener("click",e=>{e.target===i&&N()});let b;window.addEventListener("resize",()=>{clearTimeout(b),b=setTimeout(()=>{const e=s;T(),e!==s&&S()},150)});const A=document.getElementById("carousel-skeleton");A&&A.remove();const M=document.querySelector('.filter-btn[data-filter="featured"]');M&&M.click();
